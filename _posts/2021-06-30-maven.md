---
layout: single
title:  "maven"
categories: 
  - Java
tags: 
  - maven
toc: true
toc_sticky: true
date: 2021-06-30
last_modified_at: 2021-07-02
---

## 🍀maven

자바 빌드를 도와주는 <u>빌드툴</u>이다. `Gradle`, `Ant` 등이 있다.

#### 🌲 빌드 과정

![maven Build tool](https://user-images.githubusercontent.com/73654909/124113965-fda7f000-daa6-11eb-805c-9b5f54e1cded.jpg)

프로젝트 생성과 라이브러리설정 작업을 하는 것을 빌드툴이라고 한다.

#### 🌲 설치 방법

1. [Apache Maven](https://maven.apache.org/){:target="_blank"}에 접속하여 `Binary zip archive`을 다운받고 적당한 위치에 압축을 푼다.
2. <u>환경변수를 설정</u>한다. `%M2_HOME%`에 설치경로를 작성하고, `path`에 `%M2_HOME%\bin` 작성하여 등록한다.
3. cmd 창을 열어 `mvn -version`을 입력하여 잘 설치되었는지 확인한다.

#### 🌲 사용법

##### 🍁 자바 프로젝트 생성

```
mvn archetype:generate -D	//archetype 생성
groupId=그룹 이름 -D		//그룹 이름 설정 (패키지와 비슷)
artifactId=프로젝트 이름 -D	//프로젝트 이름 설정
archetypeArtifactId=maven-archetype-quickstart	//자바 개발시 이용되는 기본 템플릿
```

##### 🍁 컴파일

❗주의사항 : `pom.xml`, `src`가 <u>존재하는 폴더에서 실행</u>해야 하고, cmd에 `mvn compile`을 입력하면 컴파일이 작동한다. 만약, 더 이상 지원하지 않는 버전이라 업데이트 하라고 뜨면 아래 코드를 `pom.xml`에 작성한다. 설정하지 않았을시 메이븐의 퀵스타트 버전의 기본 JDK1.5버전이 사용된다.

```xml
</dependencies>    
	...
	<properties>
	   	<maven.compiler.source>1.8</maven.compiler.source>
		<maven.compiler.target>1.8</maven.compiler.target>
	</properties>
	...
</project>
```

mvn <u>패키지를 만들고 싶으면</u> `mvn package`를 cmd에 입력하면 `.jar`파일을 만들어준다. 이 jar파일의 확장자를 `.zip`으로 변경하여 내용을 확인 할 수 있는데 안에는 실행파일인 `.class`파일이 들어있다. 이를 아래 방법을 이용하면 정상적으로 실행된다.

```
java -cp target\라이브러리.jar 클래스이름
```

##### 🍁 실행 순서 (LifeCycle)

Maven은 [Default LifeCycle](https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#Lifecycle_Reference){:target="_blank"} 을 따라 `compile, test, package`등 <u>원하는 위치까지 자동으로 실행</u>해 준다. 이는 자바, 웹에 따라 단계가 다를 수 있지만, <u>일반적으로는 단계가 비슷</u>하다. 그리고 패키징은 `jar,war`등으로 변경이 가능한데 이는 `pom.xml(Project Object Model)`에서 설정 가능하다.

###### 🍂 Phase, Plug-in, Goal

각 단계별(`Phase`) 프로그램들이 맵핑되어 있고 <u>각 단계별 실행되는 프로그램</u>을 `Plug-in`이라 하고 maven이 제공하는 [기본플러그인](https://maven.apache.org/plugins/index.html)과 다른 곳에서 구하는 플러그인이 있다. `Plug-in` 내부의 프로그램을 `Goal`이라하고, <u>플러그인을 설정하고 교체하는 것을 담당하는 것</u>이 `pom.xml`이다. 아래는 compile시 필요한 플러그인을 출력하는 명령어이다. 

```
mvn help:describe -Dcmd=compile
결과>
It is a part of the lifecycle for the POM packaging 'jar'. This lifecycle includes the following phases:
* validate: Not defined
* initialize: Not defined
* generate-sources: Not defined
* process-sources: Not defined
* generate-resources: Not defined
* process-resources: org.apache.maven.plugins:maven-resources-plugin:2.6:resources
* compile: org.apache.maven.plugins:maven-compiler-plugin:3.1:compile
* process-classes: Not defined
* generate-test-sources: Not defined
* process-test-sources: Not defined
* generate-test-resources: Not defined
* process-test-resources: org.apache.maven.plugins:maven-resources-plugin:2.6:testResources
* test-compile: org.apache.maven.plugins:maven-compiler-plugin:3.1:testCompile
* process-test-classes: Not defined
* test: org.apache.maven.plugins:maven-surefire-plugin:2.12.4:test
* prepare-package: Not defined
* package: org.apache.maven.plugins:maven-jar-plugin:2.4:jar
* pre-integration-test: Not defined
* integration-test: Not defined
* post-integration-test: Not defined
* verify: Not defined
* install: org.apache.maven.plugins:maven-install-plugin:2.4:install
* deploy: org.apache.maven.plugins:maven-deploy-plugin:2.7:deploy
```

위의 결과중 `compile`를 변경하기 위해 `pom.xml`을 이용하여 JDK버전을 변경할 수 있다.

```xml
	...  
</dependencies>
  <!-- 플러그인 재정의 (override)-->
  <build>
  	<plugins>
  		<plugin>
  			<!-- 플러그인 이름 -->
	  		<artifactId>maven-compiler-plugin</artifactId>
            		<!-- 플러그인 버전 -->
	  		<version>3.8.1</version>
	  		<configuration>
	  			<source>1.8</source>
	  			<target>1.8</target>
	  		</configuration>
  		</plugin>
  	</plugins>
  </build>
</project>
```

![Eclipse_maven_2](https://user-images.githubusercontent.com/73654909/124161486-6d829e80-dad8-11eb-9e9f-07f9c93b4c35.jpg)

플러그인의 버전이 올라감에 따라 `source,target`을 변경하고 싶을때는 오버라이드하듯 적용할 필요 없이 위해서 작성한 `maven.compiler.source, target` 방식으로 작성해도 된다. 다만, <u>플러그인이 가진 자세한 속성을 사용하고자 할때</u>는 `오버라이드 방식`을 이용한다.

